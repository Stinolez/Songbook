"use strict";var app=function(){var appName="Zpěvník",appVersion="01.0001",appOwner="Tomáš 'Stínolez' Vitásek";function createElement(elementType,data){let element=document.createElement(elementType),attributes=JSON.parse(data[1]);switch(elementType){case"div":case"span":case"h2":case"p":case"tr":case"td":case"li":case"img":element.className=data[0],element.innerHTML=data[2];for(let attr in attributes)-1===attr.indexOf("data-")?element[attr]=attributes[attr]:element.dataset[attr.replace("data-","")]=attributes[attr];break;case"ul":case"ol":let listData=data[2];element.className=data[0];for(let attr in attributes)-1===attr.indexOf("data-")?element[attr]=attributes[attr]:element.dataset[attr.replace("data-","")]=attributes[attr];for(let i=0;i<listData.length;i++){let sub=createElement("li",listData[i]);element.appendChild(sub)}}return element}function loadJSON(callback,filepath){var xobj=new XMLHttpRequest;xobj.overrideMimeType("application/json"),xobj.open("GET",filepath,!0),xobj.onreadystatechange=function(){4==xobj.readyState&&"200"==xobj.status&&callback(xobj.responseText)},xobj.send(null)}function comparable(str){return str.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}function sortByKey(array,key){return array.sort((function(a,b){let x=comparable(a[key]),y=comparable(b[key]);return x<y?-1:x>y?1:0}))}function decodeChords(str){return str.replaceAll("{",'<span class="chord">').replaceAll("}","</span>")}function registerSongs(json){let data=JSON.parse(json).data,songList=document.getElementById("song-list");data=sortByKey(data,"name");for(let i=0;i<data.length;i++){let name=data[i].name,author,tags,uid,d_attr={"data-tags":comparable(name+"|"+data[i].author),"data-uid":data[i].uid},song=createElement("li",["song",JSON.stringify(d_attr),name]);songList.appendChild(song)}if(document.getElementsByClassName("song").length>0)for(let i=0;i<document.getElementsByClassName("song").length;i++)document.getElementsByClassName("song")[i].addEventListener("click",(function(e){location.href="index.html?uid="+e.target.dataset.uid}))}function registerSong(json){let data=JSON.parse(json),songDetail=document.getElementById("song-detail"),songText=createElement("div",["song-text","{}",""]);songDetail.innerHTML="";let title=createElement("h2",["","{}",data.name+' <span class="author">('+data.author+", takt: "+data.timing+")</span>"]);songDetail.appendChild(title);for(let i=0;i<data.chords.length;i++){let image,i_attr={src:"images/chords/"+data.chords[i]+".png",alt:data.chords[i]},img=createElement("img",["",JSON.stringify(i_attr),""]);songDetail.appendChild(img)}for(let i=0;i<data.text.length;i++){let section=data.text[i],songSection=createElement("div",["song-section","{}",""]);for(let j=0;j<section.length;j++){let text,songLine=createElement("p",["song-line","{}",decodeChords(section[j])]);songSection.appendChild(songLine)}songText.appendChild(songSection)}songDetail.appendChild(songText)}return{getAppName:function(){return appName},getAppVersion:function(){return"01.0001"},getAppOwner:function(){return appOwner},createElement:function(elementType,data){return createElement(elementType,data)},init:function(){if(document.getElementById("song-search")&&document.getElementById("song-search").addEventListener("keyup",(function(e){let search=comparable(document.getElementById("song-search").value);if(""!==search)for(let i=0;i<document.getElementsByClassName("song").length;i++){let tags,matches;0===document.getElementsByClassName("song")[i].dataset.tags.split("|").filter(s=>s.includes(search)).length?document.getElementsByClassName("song")[i].style.display="none":document.getElementsByClassName("song")[i].style.display="block"}else for(let i=0;i<document.getElementsByClassName("song").length;i++)document.getElementsByClassName("song")[i].style.display="block"})),document.getElementById("song-list")&&loadJSON(registerSongs,"../data/_main.json"),document.getElementById("song-detail")){const queryString=window.location.search,urlParams=new URLSearchParams(queryString);urlParams.get("uid")&&loadJSON(registerSong,"../data/"+urlParams.get("uid")+".json")}}}}();app.init();
//# sourceMappingURL=app.min.js.map